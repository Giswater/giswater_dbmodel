/*
This file is part of Giswater 3
The program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
This version of Giswater is provided by Giswater Association
*/

DELETE FROM config_form_fields WHERE formname='visit_arc_leak' AND formtype='form_visit' AND columnname='visit_id' AND tabname='tab_data';
DELETE FROM config_form_fields WHERE formname='visit_node_insp' AND formtype='form_visit' AND columnname='visit_id' AND tabname='tab_data';
DELETE FROM config_form_fields WHERE formname='incident_node' AND formtype='form_visit' AND columnname='visit_id' AND tabname='tab_data';

INSERT INTO config_form_fields (formname, formtype, tabname, columnname, layoutname, layoutorder, "datatype", widgettype, "label", tooltip, placeholder, ismandatory, isparent, iseditable, isautoupdate, isfilter, dv_querytext, dv_orderby_id, dv_isnullvalue, dv_parent_id, dv_querytext_filterc, stylesheet, widgetcontrols, widgetfunction, linkedobject, hidden, web_layoutorder)
    VALUES('generic', 'form_visit', 'tab_data', 'visit_id', 'lyt_data_1', NULL, 'double', 'text', 'Visit id:', NULL, NULL, false, false, false, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, false, 1);

UPDATE config_form_fields SET web_layoutorder=2 WHERE formname='visit_connec_leak' AND formtype='form_visit' AND columnname='class_id' AND tabname='tab_data';
UPDATE config_form_fields SET web_layoutorder=2 WHERE formname='incident_node' AND formtype='form_visit' AND columnname='class_id' AND tabname='tab_data';
UPDATE config_form_fields SET web_layoutorder=2 WHERE formname='visit_arc_leak' AND formtype='form_visit' AND columnname='class_id' AND tabname='tab_data';
UPDATE config_form_fields SET web_layoutorder=2 WHERE formname='visit_node_insp' AND formtype='form_visit' AND columnname='class_id' AND tabname='tab_data';


INSERT INTO config_typevalue (typevalue, id, idval, camelstyle, addparam) VALUES ('layout_name_typevalue', 'lyt_main_1', 'lyt_main_1', 'layoutMain1', '{"lytOrientation":"vertical"}');
INSERT INTO config_typevalue (typevalue, id, idval, camelstyle, addparam) VALUES ('layout_name_typevalue', 'lyt_main_2', 'lyt_main_2', 'layoutMain2', NULL);
INSERT INTO config_typevalue (typevalue, id, idval, camelstyle, addparam) VALUES ('layout_name_typevalue', 'lyt_main_3', 'lyt_main_3', 'layoutMain3', NULL);
INSERT INTO config_typevalue (typevalue, id, idval, camelstyle, addparam) VALUES ('formtype_typevalue', 'form_featuretype_change', 'form_featuretype_change', 'formFeaturetypeChange', NULL);

INSERT INTO config_form_fields (formname, formtype, tabname, columnname, layoutname, layoutorder, "datatype", widgettype, "label", tooltip, placeholder, ismandatory, isparent, iseditable, isautoupdate, isfilter, dv_querytext, dv_orderby_id, dv_isnullvalue, dv_parent_id, dv_querytext_filterc, stylesheet, widgetcontrols, widgetfunction, linkedobject, hidden, web_layoutorder) VALUES ('generic', 'form_featuretype_change', 'tab_none', 'btn_accept', 'lyt_buttons', 2, NULL, 'button', NULL, NULL, NULL, FALSE, FALSE, TRUE, FALSE, NULL, NULL, NULL, NULL, NULL, NULL, NULL, '{"text": "Accept"}'::json, '{"functionName": "btn_accept_featuretype_change", "module": "featuretype_change_button", "parameters": {}}'::json, NULL, FALSE, NULL);
INSERT INTO config_form_fields (formname, formtype, tabname, columnname, layoutname, layoutorder, "datatype", widgettype, "label", tooltip, placeholder, ismandatory, isparent, iseditable, isautoupdate, isfilter, dv_querytext, dv_orderby_id, dv_isnullvalue, dv_parent_id, dv_querytext_filterc, stylesheet, widgetcontrols, widgetfunction, linkedobject, hidden, web_layoutorder) VALUES ('generic', 'form_featuretype_change', 'tab_none', 'spacer', 'lyt_buttons', 1, NULL, 'hspacer', NULL, NULL, NULL, FALSE, FALSE, TRUE, FALSE, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, FALSE, NULL);
INSERT INTO config_form_fields (formname, formtype, tabname, columnname, layoutname, layoutorder, "datatype", widgettype, "label", tooltip, placeholder, ismandatory, isparent, iseditable, isautoupdate, isfilter, dv_querytext, dv_orderby_id, dv_isnullvalue, dv_parent_id, dv_querytext_filterc, stylesheet, widgetcontrols, widgetfunction, linkedobject, hidden, web_layoutorder) VALUES ('generic', 'form_featuretype_change', 'tab_none', 'btn_cancel', 'lyt_buttons', 3, NULL, 'button', NULL, NULL, NULL, FALSE, FALSE, TRUE, FALSE, NULL, NULL, NULL, NULL, NULL, NULL, NULL, '{"text": "Cancel"}'::json, '{"functionName": "btn_cancel_featuretype_change", "module": "featuretype_change_button", "parameters": {}}'::json, NULL, FALSE, NULL);
INSERT INTO config_form_fields (formname, formtype, tabname, columnname, layoutname, layoutorder, "datatype", widgettype, "label", tooltip, placeholder, ismandatory, isparent, iseditable, isautoupdate, isfilter, dv_querytext, dv_orderby_id, dv_isnullvalue, dv_parent_id, dv_querytext_filterc, stylesheet, widgetcontrols, widgetfunction, linkedobject, hidden, web_layoutorder) VALUES ('generic', 'form_featuretype_change', 'tab_none', 'btn_catalog', 'lyt_main_2', 3, NULL, 'button', NULL, NULL, NULL, FALSE, FALSE, TRUE, FALSE, NULL, NULL, NULL, NULL, NULL, NULL, '{"icon": "195", "size": "20x20"}'::json, NULL, '{"functionName": "btn_catalog_featuretype_change", "module": "featuretype_change_button", "parameters": {}}'::json, NULL, FALSE, NULL);
INSERT INTO config_form_fields (formname, formtype, tabname, columnname, layoutname, layoutorder, "datatype", widgettype, "label", tooltip, placeholder, ismandatory, isparent, iseditable, isautoupdate, isfilter, dv_querytext, dv_orderby_id, dv_isnullvalue, dv_parent_id, dv_querytext_filterc, stylesheet, widgetcontrols, widgetfunction, linkedobject, hidden, web_layoutorder) VALUES ('generic', 'form_featuretype_change', 'tab_none', 'feature_type', 'lyt_main_1', 1, 'string', 'text', 'Current feature type', 'Current feature type', NULL, FALSE, FALSE, FALSE, FALSE, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, FALSE, NULL);
INSERT INTO config_form_fields (formname, formtype, tabname, columnname, layoutname, layoutorder, "datatype", widgettype, "label", tooltip, placeholder, ismandatory, isparent, iseditable, isautoupdate, isfilter, dv_querytext, dv_orderby_id, dv_isnullvalue, dv_parent_id, dv_querytext_filterc, stylesheet, widgetcontrols, widgetfunction, linkedobject, hidden, web_layoutorder) VALUES ('generic', 'form_featuretype_change', 'tab_none', 'feature_type_new', 'lyt_main_1', 1, 'string', 'combo', 'New feature type', 'New feature type', NULL, FALSE, FALSE, TRUE, FALSE, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, '{"functionName": "cmb_new_featuretype_selection_changed", "module": "featuretype_change_button", "parameters": {}}'::json, NULL, FALSE, NULL);
INSERT INTO config_form_fields (formname, formtype, tabname, columnname, layoutname, layoutorder, "datatype", widgettype, "label", tooltip, placeholder, ismandatory, isparent, iseditable, isautoupdate, isfilter, dv_querytext, dv_orderby_id, dv_isnullvalue, dv_parent_id, dv_querytext_filterc, stylesheet, widgetcontrols, widgetfunction, linkedobject, hidden, web_layoutorder) VALUES ('generic', 'form_featuretype_change', 'tab_none', 'featurecat_id', 'lyt_main_2', 1, 'string', 'combo', 'Catalog id', 'Catalog id', NULL, FALSE, FALSE, TRUE, FALSE, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, FALSE, NULL);
INSERT INTO config_form_fields (formname, formtype, tabname, columnname, layoutname, layoutorder, "datatype", widgettype, "label", tooltip, placeholder, ismandatory, isparent, iseditable, isautoupdate, isfilter, dv_querytext, dv_orderby_id, dv_isnullvalue, dv_parent_id, dv_querytext_filterc, stylesheet, widgetcontrols, widgetfunction, linkedobject, hidden, web_layoutorder) VALUES ('generic', 'form_featuretype_change', 'tab_none', 'fluid_type', 'lyt_main_3', 1, 'string', 'combo', 'Fluid', 'Fluid', NULL, FALSE, FALSE, TRUE, FALSE, NULL, NULL, NULL, NULL, NULL, NULL, NULL, '{"labelPosition": "top"}'::json, NULL, NULL, FALSE, NULL);
INSERT INTO config_form_fields (formname, formtype, tabname, columnname, layoutname, layoutorder, "datatype", widgettype, "label", tooltip, placeholder, ismandatory, isparent, iseditable, isautoupdate, isfilter, dv_querytext, dv_orderby_id, dv_isnullvalue, dv_parent_id, dv_querytext_filterc, stylesheet, widgetcontrols, widgetfunction, linkedobject, hidden, web_layoutorder) VALUES ('generic', 'form_featuretype_change', 'tab_none', 'location_type', 'lyt_main_3', 2, 'string', 'combo', 'Location', 'Location', NULL, FALSE, FALSE, TRUE, FALSE, NULL, NULL, NULL, NULL, NULL, NULL, NULL, '{"labelPosition": "top"}'::json, NULL, NULL, FALSE, NULL);
INSERT INTO config_form_fields (formname, formtype, tabname, columnname, layoutname, layoutorder, "datatype", widgettype, "label", tooltip, placeholder, ismandatory, isparent, iseditable, isautoupdate, isfilter, dv_querytext, dv_orderby_id, dv_isnullvalue, dv_parent_id, dv_querytext_filterc, stylesheet, widgetcontrols, widgetfunction, linkedobject, hidden, web_layoutorder) VALUES ('generic', 'form_featuretype_change', 'tab_none', 'category_type', 'lyt_main_3', 3, 'string', 'combo', 'Category', 'Category', NULL, FALSE, FALSE, TRUE, FALSE, NULL, NULL, NULL, NULL, NULL, NULL, NULL, '{"labelPosition": "top"}'::json, NULL, NULL, FALSE, NULL);
INSERT INTO config_form_fields (formname, formtype, tabname, columnname, layoutname, layoutorder, "datatype", widgettype, "label", tooltip, placeholder, ismandatory, isparent, iseditable, isautoupdate, isfilter, dv_querytext, dv_orderby_id, dv_isnullvalue, dv_parent_id, dv_querytext_filterc, stylesheet, widgetcontrols, widgetfunction, linkedobject, hidden, web_layoutorder) VALUES ('generic', 'form_featuretype_change', 'tab_none', 'function_type', 'lyt_main_3', 4, 'string', 'combo', 'Function', 'Function', NULL, FALSE, FALSE, TRUE, FALSE, NULL, NULL, NULL, NULL, NULL, NULL, NULL, '{"labelPosition": "top"}'::json, NULL, NULL, FALSE, NULL);

INSERT INTO sys_function (id, function_name, project_type, function_type, input_params, return_type, descript, sys_role, sample_query, "source") VALUES (3324, 'gw_fct_getfeaturereplace', 'utils', 'function', 'json', 'json', 'Function to get feature type change dialog', 'role_edit', NULL, 'core');

-- 17/09/2024

INSERT INTO sys_fprocess (fid, fprocess_name, project_type, parameters, "source", isaudit, fprocess_type, addparam, except_level, except_msg, except_msg_feature, query_text, info_msg, function_name) VALUES(532, 'Check for inp_arc tables and epa_type consistency', 'utils', NULL, 'core', true, 'Check epa-data', NULL, 3, 'arcs features with epa_type not according with epa table. Check your data before continue.', NULL, 'with sub1 as (SELECT 295, a.arc_id, a.arccat_id, concat(epa_type, '' using inp_pipe table'') AS epa_table, a.the_geom, a.sector_id FROM v_edit_inp_virtualvalve JOIN arc a USING (arc_id) WHERE epa_type !=''VIRTUAL''
		UNION
		SELECT 295, a.arc_id, a.arccat_id,  concat(epa_type, '' using inp_virtualvalve table'') AS epa_table, a.the_geom, a.sector_id FROM v_edit_inp_pipe JOIN arc a USING (arc_id) WHERE epa_type !=''PIPE''
) select*from sub1', 'Epa type for arcs features checked. No inconsistencies aganints epa table found.Epa type for connec features checked. No inconsistencies aganints epa table found.', '[gw_fct_pg2epa_check_data]') ON CONFLICT (fid) DO NOTHING;

INSERT INTO sys_fprocess (fid, fprocess_name, project_type, parameters, "source", isaudit, fprocess_type, addparam, except_level, except_msg, except_msg_feature, query_text, info_msg, function_name) VALUES(533, 'Check that EPA OBJECTS (patterns) name do not contain spaces', 'utils', NULL, 'core', true, 'Check epa-config', NULL, 3, 'patterns name with spaces. Please fix it!', NULL, 'SELECT * FROM inp_pattern WHERE pattern_id like''% %''', 'All patterns checked have names without spaces.''      All patterns checked have names without spaces.', '[gw_fct_pg2epa_check_data]') ON CONFLICT (fid) DO NOTHING;

INSERT INTO sys_fprocess (fid, fprocess_name, project_type, parameters, "source", isaudit, fprocess_type, addparam, except_level, except_msg, except_msg_feature, query_text, info_msg, function_name) VALUES(538, 'Features state=0 without end date', 'utils', NULL, 'core', true, 'Check om-data', NULL, 2, 'features with state 0 without value of end date.', NULL, 'SELECT arc_id as feature_id from v_prefix_arc where state = 0 and enddate is null UNION 
SELECT node_id from v_prefix_node where state = 0 and enddate is null UNION 
SELECT connec_id from v_prefix_connec where state = 0 and enddate is null', 'No features with state 0 are missing the end date', '[gw_fct_om_check_data]') ON CONFLICT (fid) DO NOTHING;

INSERT INTO sys_fprocess (fid, fprocess_name, project_type, parameters, "source", isaudit, fprocess_type, addparam, except_level, except_msg, except_msg_feature, query_text, info_msg, function_name) VALUES(540, 'Orphan polygons', 'utils', NULL, 'core', true, 'Check om-topology', NULL, 2, 'polygons without parent. Check your data before continue. polygons without parent. Check your data before continue.', NULL, 'SELECT pol_id FROM polygon WHERE feature_id IS NULL OR feature_id NOT IN (SELECT node_id FROM node UNION SELECT connec_id FROM connec)', 'No polygons without parent feature found.', '[gw_fct_om_check_data]') ON CONFLICT (fid) DO NOTHING;


UPDATE sys_fprocess SET fprocess_name='Qgis project check', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=101;
UPDATE sys_fprocess SET fprocess_name='Schema data consistency', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Not used', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=102;
UPDATE sys_fprocess SET fprocess_name='Arc without start-end nodes', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-topology', addparam=NULL, except_level=3, except_msg='arcs with state=1 and without node_1 or node_2.', except_msg_feature=NULL, query_text='SELECT arc_id,arccat_id,the_geom, expl_id FROM v_prefix_arc WHERE state = 1 AND node_1 IS NULL UNION 
SELECT arc_id, arccat_id, the_geom, expl_id FROM v_prefix_arc WHERE state = 1 AND node_2 IS NULL', info_msg='No arc''''s with state=1 and without node_1 or node_2 nodes found.', function_name='[gw_fct_om_check_data, gw_fct_admin_check_data]' WHERE fid=103;
UPDATE sys_fprocess SET fprocess_name='Arc with same start-end nodes', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=104;
UPDATE sys_fprocess SET fprocess_name='Connec duplicated', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=105;
UPDATE sys_fprocess SET fprocess_name='Node duplicated', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-topology', addparam=NULL, except_level=3, except_msg='nodes duplicated with state 1.', except_msg_feature=NULL, query_text='SELECT * FROM 
(SELECT DISTINCT t1.node_id AS node_1, t1.nodecat_id AS nodecat_1, t1.state as state1, 
t2.node_id AS node_2, t2.nodecat_id AS nodecat_2, t2.state as state2, t1.expl_id, 106, t1.the_geom 
FROM v_prefix_node AS t1 JOIN node AS t2 ON ST_Dwithin(t1.the_geom, t2.the_geom, 0.01) 
WHERE t1.node_id != t2.node_id ORDER BY t1.node_id ) a where a.state1 = 1 AND a.state2 = 1', info_msg='There are no nodes duplicated with state 1', function_name='[gw_fct_om_check_data, gw_fct_admin_check_data]' WHERE fid=106;
UPDATE sys_fprocess SET fprocess_name='Node orphan (EPA)', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-topology', addparam=NULL, except_level=2, except_msg='nodes orphans ready-to-export (epa_type & state_type). If they are actually orphan, you could change the epa_type to fix it''', except_msg_feature=NULL, query_text='SELECT node_id, nodecat_id, the_geom, expl_id FROM 
(SELECT node_id FROM v_edit_node EXCEPT (SELECT node_1 as node_id FROM v_edit_arc UNION SELECT node_2 FROM v_edit_arc))a 
JOIN node USING (node_id)   JOIN selector_sector USING (sector_id) JOIN value_state_type v ON state_type = v.id 
WHERE epa_type != ''UNDEFINED'' and is_operative = true and cur_user = current_user and arc_id IS NULL', info_msg='No nodes orphan found.', function_name='[gw_fct_pg2epa_check_data, gw_fct_admin_check_data]' WHERE fid=107;
UPDATE sys_fprocess SET fprocess_name='Node topological consistency', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=108;
UPDATE sys_fprocess SET fprocess_name='EPA check data', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-result', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=114;
UPDATE sys_fprocess SET fprocess_name='PLAN check data', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=115;
UPDATE sys_fprocess SET fprocess_name='Log updated or deleted features', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=117;
UPDATE sys_fprocess SET fprocess_name='Repair arcs', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=118;
UPDATE sys_fprocess SET fprocess_name='Check user value defaults', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Not used', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=119;
UPDATE sys_fprocess SET fprocess_name='UI export-import', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=120;
UPDATE sys_fprocess SET fprocess_name='Check plan multi-sector node', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Not used', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=121;
UPDATE sys_fprocess SET fprocess_name='Check v_edit_node duplicated nodes', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Not used', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=122;
UPDATE sys_fprocess SET fprocess_name='Check v_edit_node orphan nodes', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Not used', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=123;
UPDATE sys_fprocess SET fprocess_name='Nodarcs generation', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=124;
UPDATE sys_fprocess SET fprocess_name='Auxiliar cad points', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=127;
UPDATE sys_fprocess SET fprocess_name='Massive downgrade features', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=128;
UPDATE sys_fprocess SET fprocess_name='Node proximity analysis', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=132;
UPDATE sys_fprocess SET fprocess_name='Update project data schema', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=133;
UPDATE sys_fprocess SET fprocess_name='Recursive go2epa process', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=135;
UPDATE sys_fprocess SET fprocess_name='admin check, fk and unique constraints', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=136;
UPDATE sys_fprocess SET fprocess_name='admin not null contraints', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=137;
UPDATE sys_fprocess SET fprocess_name='Check inconsistency on editable data', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=138;
UPDATE sys_fprocess SET fprocess_name='Epa import rpt results', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=140;
UPDATE sys_fprocess SET fprocess_name='Epa import inp files', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=141;
UPDATE sys_fprocess SET fprocess_name='Replace feature', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=143;
UPDATE sys_fprocess SET fprocess_name='EPA calibration', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=149;
UPDATE sys_fprocess SET fprocess_name='Set feature relations', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=151;
UPDATE sys_fprocess SET fprocess_name='Delete feature', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=152;
UPDATE sys_fprocess SET fprocess_name='Get layers name into TOC', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=163;
UPDATE sys_fprocess SET fprocess_name='Update elevation from DEM', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=168;
UPDATE sys_fprocess SET fprocess_name='Null values on state_type column', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-data', addparam=NULL, except_level=3, except_msg='topologic features (arc, node) with state_type with NULL values. Please, check your data before continue', except_msg_feature=NULL, query_text='SELECT arc_id FROM v_prefix_arc WHERE state > 0 AND state_type IS NULL UNION SELECT node_id FROM v_prefix_node WHERE state > 0 AND state_type IS NULL', info_msg='No topologic features (arc, node) with state_type NULL values found.', function_name='[gw_fct_om_check_data, gw_fct_admin_check_data]' WHERE fid=175;
UPDATE sys_fprocess SET fprocess_name='Nodes with state_type is_operative false', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-data', addparam=NULL, except_level=2, except_msg='nodes with state > 0 and state_type.is_operative on FALSE. Please, check your data before continue', except_msg_feature=NULL, query_text='SELECT node_id, nodecat_id, the_geom, n.expl_id FROM node n JOIN value_state_type s ON id=state_type WHERE n.state > 0 AND s.is_operative IS FALSE AND verified <>''2''', info_msg='No nodes with state > 0 AND state_type.is_operative on FALSE found.', function_name='[gw_fct_om_check_data, gw_fct_pg2epa_check_data, gw_fct_admin_check_data]' WHERE fid=187;
UPDATE sys_fprocess SET fprocess_name='Arcs with state_type is_operative false', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-data', addparam=NULL, except_level=2, except_msg='arcs with state > 0 and state_type.is_operative on FALSE. Please, check your data before continue', except_msg_feature=NULL, query_text='SELECT arc_id, arccat_id, the_geom, a.expl_id FROM v_prefix_arc a JOIN value_state_type s ON id=state_type  
WHERE a.state > 0 AND s.is_operative IS FALSE AND verified <>''2''', info_msg='No arcs with state > 0 AND state_type.is_operative on FALSE found.', function_name='[gw_fct_om_check_data, gw_fct_pg2epa_check_data, gw_fct_admin_check_data]' WHERE fid=188;
UPDATE sys_fprocess SET fprocess_name='Admin check data', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=195;
UPDATE sys_fprocess SET fprocess_name='Arcs with state=1 using nodes on state=0', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-topology', addparam=NULL, except_level=3, except_msg='arcs with state=1 using extremals nodes with state = 0. Please, check your data before continue', except_msg_feature=NULL, query_text='SELECT a.arc_id, arccat_id, a.the_geom, a.expl_id FROM v_prefix_arc a 
JOIN v_prefix_node n ON node_1=node_id WHERE a.state =1 AND n.state=0 UNION 
SELECT a.arc_id, arccat_id, a.the_geom, a.expl_id FROM v_prefix_arc a 
JOIN v_prefix_node n ON node_2=node_id WHERE a.state =1 AND n.state=0', info_msg='No arcs with state=1 using nodes with state=0 found.', function_name='[gw_fct_om_check_data, gw_fct_admin_check_data]' WHERE fid=196;
UPDATE sys_fprocess SET fprocess_name='Arcs with state=1 using nodes on state=2', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-topology', addparam=NULL, except_level=3, except_msg='arcs with state=1 using extremals nodes with state = 2. Please, check your data before continue', except_msg_feature=NULL, query_text='SELECT a.arc_id, arccat_id, a.the_geom, a.expl_id FROM v_prefix_arc a JOIN v_prefix_node n ON node_1=node_id 
WHERE a.state =1 AND n.state=2 UNION   SELECT a.arc_id, arccat_id, a.the_geom, a.expl_id FROM v_prefix_arc a 
JOIN v_prefix_node n ON node_2=node_id WHERE a.state =1 AND n.state=2', info_msg='No arcs with state=1 using nodes with state=0 found.', function_name='[gw_fct_om_check_data, gw_fct_admin_check_data]' WHERE fid=197;
UPDATE sys_fprocess SET fprocess_name='Connecs with duplicated customer_code', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-data', addparam=NULL, except_level=2, except_msg='connecs customer code duplicated. Please, check your data before continue', except_msg_feature=NULL, query_text='SELECT customer_code FROM v_prefix_connec WHERE state=1 and customer_code IS NOT NULL group by customer_code, expl_id having count(*) > 1', info_msg='No connecs with customer code duplicated.', function_name='[gw_fct_om_check_data, gw_fct_admin_check_data]' WHERE fid=201;
UPDATE sys_fprocess SET fprocess_name='Final nodes with arc_id', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=203;
UPDATE sys_fprocess SET fprocess_name='Role upsertuser', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=207;
UPDATE sys_fprocess SET fprocess_name='Connecs with customer code null', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-data', addparam=NULL, except_level=2, except_msg='connecs with customer code null. Please, check your data before continue', except_msg_feature=NULL, query_text='SELECT connec_id FROM v_prefix_connec WHERE state=1 and customer_code IS NULL', info_msg='No connecs with null customer code.', function_name='[gw_fct_om_check_data, gw_fct_admin_check_data]' WHERE fid=210;
UPDATE sys_fprocess SET fprocess_name='Graphanalytics check data', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=211;
UPDATE sys_fprocess SET fprocess_name='Arc divide', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=212;
UPDATE sys_fprocess SET fprocess_name='Node interpolate', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=213;
UPDATE sys_fprocess SET fprocess_name='Arc fusion', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=214;
UPDATE sys_fprocess SET fprocess_name='Test functions', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=215;
UPDATE sys_fprocess SET fprocess_name='Connect to network', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=217;
UPDATE sys_fprocess SET fprocess_name='Define addfields', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=218;
UPDATE sys_fprocess SET fprocess_name='Define visit class', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=219;
UPDATE sys_fprocess SET fprocess_name='Profile analysis', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=222;
UPDATE sys_fprocess SET fprocess_name='Check arc drawing direction', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-topology', addparam=NULL, except_level=2, except_msg='arcs with drawing direction different than definition of node_1, node_2', except_msg_feature=NULL, query_text='SELECT a.arc_id , arccat_id, a.the_geom, a.expl_id FROM v_prefix_arc a, v_prefix_node n WHERE st_dwithin(st_startpoint(a.the_geom), n.the_geom, 0.0001) and node_2 = node_id   UNION   SELECT a.arc_id , arccat_id, a.the_geom, a.expl_id  FROM v_prefix_arc a, v_prefix_node n WHERE st_dwithin(st_endpoint(a.the_geom), n.the_geom, 0.0001) and node_1 = node_id', info_msg='No arcs with drawing direction different than definition of node_1, node_2', function_name='[gw_fct_om_check_data, gw_fct_admin_check_data]' WHERE fid=223;
UPDATE sys_fprocess SET fprocess_name='role epa check network data', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=225;
UPDATE sys_fprocess SET fprocess_name='Go2epa check', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-network', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=227;
UPDATE sys_fprocess SET fprocess_name='Arcs less than 20 cm.', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-topology', addparam=NULL, except_level=2, except_msg='pipes with length less than node proximity distance configured.', except_msg_feature=NULL, query_text='SELECT * FROM v_edit_inp_pipe WHERE st_length(the_geom) < (SELECT value::json->>''value'' FROM config_param_system WHERE parameter = ''edit_node_proximity'')::float', info_msg='Standard minimun length checked. No values less than node proximity distance configured.', function_name='[gw_fct_pg2epa_check_data, gw_fct_admin_check_data]' WHERE fid=229;
UPDATE sys_fprocess SET fprocess_name='arcs less than 5 cm.', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-topology', addparam=NULL, except_level=3, except_msg='pipes with length less than configured minimum length.', except_msg_feature=NULL, query_text='SELECT the_geom, st_length(the_geom) AS length FROM v_edit_inp_pipe WHERE st_length(the_geom) < (SELECT value FROM config_param_system WHERE parameter = ''epa_arc_minlength'')::float', info_msg='Critical minimun length checked. No values less than configured minimum length found.', function_name='[gw_fct_pg2epa_check_data, gw_fct_admin_check_data]' WHERE fid=230;
UPDATE sys_fprocess SET fprocess_name='Go2epa check arc without some node', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-network', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=231;
UPDATE sys_fprocess SET fprocess_name='Import db prices', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=234;
UPDATE sys_fprocess SET fprocess_name='Import elements', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=235;
UPDATE sys_fprocess SET fprocess_name='Import addfields', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=236;
UPDATE sys_fprocess SET fprocess_name='Import dxf blocks', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=237;
UPDATE sys_fprocess SET fprocess_name='Import om visit', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=238;
UPDATE sys_fprocess SET fprocess_name='Import inp', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=239;
UPDATE sys_fprocess SET fprocess_name='Import arc visits', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=240;
UPDATE sys_fprocess SET fprocess_name='Import node visits', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=241;
UPDATE sys_fprocess SET fprocess_name='Import connec visits', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=242;
UPDATE sys_fprocess SET fprocess_name='Import timeseries', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=244;
UPDATE sys_fprocess SET fprocess_name='Import visit file', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=245;
UPDATE sys_fprocess SET fprocess_name='Export ui', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=246;
UPDATE sys_fprocess SET fprocess_name='Import ui', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=247;
UPDATE sys_fprocess SET fprocess_name='Daily update', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=248;
UPDATE sys_fprocess SET fprocess_name='Orphan rows on addfields values (DEPRECATED)', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-data', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=256;
UPDATE sys_fprocess SET fprocess_name='Vnode inconsistency - link without vnode', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=258;
UPDATE sys_fprocess SET fprocess_name='Vnode inconsistency - vnode without link', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-topology', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=259;
UPDATE sys_fprocess SET fprocess_name='Link without feature_id', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-data', addparam=NULL, except_level=3, except_msg='links with state > 0 without feature_id.', except_msg_feature=NULL, query_text='SELECT link_id, the_geom FROM v_prefix_link where feature_id is null and state > 0', info_msg='All links state > 0 have feature_id.', function_name='[gw_fct_om_check_data, gw_fct_admin_check_data]' WHERE fid=260;
UPDATE sys_fprocess SET fprocess_name='Link without exit_id', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-data', addparam=NULL, except_level=3, except_msg='links with state > 0 without exit_id.', except_msg_feature=NULL, query_text='SELECT link_id, the_geom FROM v_prefix_link where exit_id is null and state > 0', info_msg='All links state > 0 have exit_id.', function_name='[gw_fct_om_check_data, gw_fct_admin_check_data]' WHERE fid=261;
UPDATE sys_fprocess SET fprocess_name='Automatic links with more than 100m', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-topology', addparam=NULL, except_level=2, except_msg='automatic links with longitude out-of-range found.', except_msg_feature=NULL, query_text='SELECT * FROM v_prefix_link where st_length(the_geom) > 100', info_msg='No automatic links with out-of-range Longitude found.', function_name='[gw_fct_om_check_data, gw_fct_admin_check_data]' WHERE fid=265;
UPDATE sys_fprocess SET fprocess_name='Missing data on inp tables', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-data', addparam=NULL, except_level=3, except_msg='missed features on inp tables. Please, check your data before continue', except_msg_feature=NULL, query_text='SELECT arc_id, ''arc'' FROM v_edit_arc LEFT JOIN    
(SELECT arc_id from inp_pipe UNION SELECT arc_id FROM inp_virtualvalve UNION SELECT arc_id FROM inp_virtualpump) b using (arc_id)   
WHERE b.arc_id IS NULL AND state > 0 AND epa_type !=''UNDEFINED'' 
UNION 
SELECT node_id, ''node'' FROM v_edit_node LEFT JOIN
(select node_id from inp_shortpipe UNION select node_id from inp_valve รง
UNION select node_id from inp_tank 
UNION select node_id FROM inp_reservoir 
UNION select node_id FROM inp_pump
UNION SELECT node_id from inp_inlet
UNION SELECT node_id from inp_junction) b USING (node_id)
WHERE b.node_id IS NULL AND state >0 AND epa_type !=''UNDEFINED''', info_msg='No features missed on inp_tables found.', function_name='[gw_fct_pg2epa_check_data, gw_fct_admin_check_data]' WHERE fid=272;
UPDATE sys_fprocess SET fprocess_name='Store psector values for specific user', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=288;
UPDATE sys_fprocess SET fprocess_name='Store exploitation values for especific user', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=289;
UPDATE sys_fprocess SET fprocess_name='Duplicated node on temp_table', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-result', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=290;
UPDATE sys_fprocess SET fprocess_name='Check for inp_node tables and epa_type consistency', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-data', addparam=NULL, except_level=3, except_msg='node features with epa_type not according with epa table. Check your data before continue', except_msg_feature=NULL, query_text='SELECT * FROM temp_anl_node WHERE fid=294 AND cur_user=current_user', info_msg='Epa type for node features checked. No inconsistencies aganints epa table found.', function_name='[gw_fct_pg2epa_check_data, gw_fct_admin_check_data]' WHERE fid=294;
UPDATE sys_fprocess SET fprocess_name='Check for inp_connec tables and epa_type consistency', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-data', addparam=NULL, except_level=3, except_msg='connecs features with epa_type not according with epa table. Check your data before continue.', except_msg_feature=NULL, query_text='SELECT * FROM (SELECT count(*) as c1, null AS c2 FROM connec UNION SELECT null, count(*) FROM inp_connec)a1 WHERE c1 > c2', info_msg='Epa type for arc features checked. No inconsistencies aganints epa table found.Epa type for connec features checked. No inconsistencies aganints epa table found.', function_name='[gw_fct_pg2epa_check_data, gw_fct_admin_check_data]' WHERE fid=295;
UPDATE sys_fprocess SET fprocess_name='Repair temp_link', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-result', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=296;
UPDATE sys_fprocess SET fprocess_name='Features with EPA type UNDEFINED', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-result', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=297;
UPDATE sys_fprocess SET fprocess_name='Control null values on crm.hydrometer.code', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam='{"addSchema":"crm"}'::json, except_level=3, except_msg='hydrometers in crm schema without code.', except_msg_feature=NULL, query_text='SELECT id FROM crm.hydrometer WHERE code IS NULL', info_msg='All hydrometers on crm schema have code', function_name='[gw_fct_om_check_data]' WHERE fid=299;
UPDATE sys_fprocess SET fprocess_name='Repair link', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=301;
UPDATE sys_fprocess SET fprocess_name='Check values of system variables', project_type='utils', parameters=NULL, "source"='core', isaudit=false, fprocess_type='Check om-data', addparam=NULL, except_level=2, except_msg='system variables with out-of-standard values.', except_msg_feature=NULL, query_text='SELECT parameter FROM config_param_system WHERE lower(value) != lower(standardvalue) AND standardvalue IS NOT NULL  AND  standardvalue NOT ILIKE ''{%}'' UNION 
SELECT parameter FROM config_param_system  WHERE lower(json_extract_path_text(value::json,''activated'')) != lower(json_extract_path_text(standardvalue::json,''activated'')) AND standardvalue IS NOT NULL AND standardvalue ILIKE ''{%}''', info_msg='No system variables with values out-of-standars found.', function_name='[gw_fct_om_check_data]' WHERE fid=302;
UPDATE sys_fprocess SET fprocess_name='Check cat_feature field active', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check admin', addparam=NULL, except_level=3, except_msg='features without value on field "active" from cat_feature.', except_msg_feature=NULL, query_text='SELECT * FROM cat_feature WHERE active IS NULL', info_msg='All features have value on field "active"', function_name='[gw_fct_admin_check_data]' WHERE fid=303;
UPDATE sys_fprocess SET fprocess_name='Check cat_feature field code_autofill', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check admin', addparam=NULL, except_level=3, except_msg='features without value on field "code_autofill" from cat_feature.', except_msg_feature=NULL, query_text='SELECT * FROM cat_feature WHERE code_autofill IS NULL', info_msg='All features have value on field "code_autofill"', function_name='[gw_fct_admin_check_data]' WHERE fid=304;
UPDATE sys_fprocess SET fprocess_name='Check cat_feature_node field num_arcs', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check admin', addparam=NULL, except_level=3, except_msg='nodes without value on field "num_arcs" from cat_feature_node.', except_msg_feature=NULL, query_text='SELECT * FROM cat_feature_node WHERE num_arcs IS NULL', info_msg='All nodes have value on field "num_arcs"', function_name='[gw_fct_admin_check_data]' WHERE fid=305;
UPDATE sys_fprocess SET fprocess_name='Check cat_feature_node field isarcdivide', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check admin', addparam=NULL, except_level=3, except_msg='nodes without value on field "isarcdivide" from cat_feature_node.', except_msg_feature=NULL, query_text='SELECT * FROM cat_feature_node WHERE isarcdivide IS NULL', info_msg='All nodes have value on field "isarcdivide"', function_name='[gw_fct_admin_check_data]' WHERE fid=306;
UPDATE sys_fprocess SET fprocess_name='Check cat_feature_node field choose_hemisphere', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check admin', addparam=NULL, except_level=3, except_msg='nodes without value on field "choose_hemisphere" from cat_feature_node.', except_msg_feature=NULL, query_text='SELECT * FROM cat_feature_node WHERE choose_hemisphere IS NULL', info_msg='All nodes have value on field "choose_hemisphere"', function_name='[gw_fct_admin_check_data]' WHERE fid=309;
UPDATE sys_fprocess SET fprocess_name='Check cat_feature_node field isprofilesurface', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check admin', addparam=NULL, except_level=3, except_msg='nodes without value on field "isprofilesurface" from cat_feature_node. Features - '',v_feature_list::text,''.''', except_msg_feature=NULL, query_text='SELECT * FROM cat_feature_node WHERE isprofilesurface IS NULL', info_msg='All nodes have value on field "isprofilesurface"', function_name='[gw_fct_admin_check_data]' WHERE fid=310;
UPDATE sys_fprocess SET fprocess_name='Check child view man table definition', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check admin', addparam=NULL, except_level=3, except_msg='view wrongly defined man_table', except_msg_feature=NULL, query_text='WITH subq_1 as (
SELECT id, system_id, child_layer from cat_Feature
), subq_2 as (
select*from information_schema.views a join subq_1 m on m.child_layer = a.table_name
where a.table_schema = current_schema
), subq_3 as (
select position(concat(''man_'',lower(system_id)) in view_definition) from subq_2
)
select*from subq_3 where position = 0', info_msg='All views are well defined in man_table', function_name='[gw_fct_admin_check_data]' WHERE fid=311;
UPDATE sys_fprocess SET fprocess_name='Check child view addfields', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check admin', addparam=NULL, except_level=2, except_msg='active addfields that may not be present on its corresponding child view:', except_msg_feature=NULL, query_text='WITH subq AS (
    SELECT s.param_name, s.cat_feature_id FROM sys_addfields s
    LEFT JOIN cat_feature f ON s.cat_feature_id = f.id
    WHERE s.feature_type = ''CHILD'' AND s.active IS TRUE AND s.cat_feature_id IS NULL
)
SELECT string_agg(concat(key, '': '', value), ''; '') AS "string_agg"
FROM (SELECT key, value 
        FROM subq, json_each_text(json_build_object(''addfield'', COALESCE(param_name, ''null''), ''cat_feature'', COALESCE(cat_feature_id::text, ''null'')
             )
         )
) AS pairs', info_msg=NULL, function_name='[gw_fct_admin_check_data]' WHERE fid=312;
UPDATE sys_fprocess SET fprocess_name='Find not existing child views', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check admin', addparam=NULL, except_level=3, except_msg='views defined in cat_feature table but is not created in a DB.', except_msg_feature=NULL, query_text='SELECT c.child_layer FROM cat_feature c
left join information_schema.views a on a.table_name= c.child_layer
where a.table_schema = current_schema and a.view_definition is null', info_msg='All child views are created and defined in cat_feature and', function_name='[gw_fct_admin_check_data]' WHERE fid=313;
UPDATE sys_fprocess SET fprocess_name='Find active features without child views', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check admin', addparam=NULL, except_level=3, except_msg='active features which views names are not present in cat_feature table.', except_msg_feature=NULL, query_text='SELECT string_agg(id,'','') FROM cat_feature WHERE active IS TRUE AND child_layer IS NULL', info_msg='All active features have child view name in cat_feature table', function_name='[gw_fct_admin_check_data]' WHERE fid=314;
UPDATE sys_fprocess SET fprocess_name='Check definition on config_info_layer_x_type', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check admin', addparam=NULL, except_level=3, except_msg='active features which views are not defined in config_info_layer_x_type.', except_msg_feature=NULL, query_text='SELECT string_agg(id, ''; '') FROM cat_feature WHERE active IS TRUE AND child_layer not in (select tableinfo_id FROM config_info_layer_x_type)', info_msg='All active features have child view defined in config_info_layer_x_type', function_name='[gw_fct_admin_check_data]' WHERE fid=315;
UPDATE sys_fprocess SET fprocess_name='Check definition on config_form_fields', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check admin', addparam=NULL, except_level=3, except_msg='active features which views are not defined in config_form_fields.', except_msg_feature=NULL, query_text='SELECT string_agg(concat(cat_feature_id, '': '', param_name), ''; '') FROM sys_addfields 
JOIN cat_feature ON cat_feature.id=sys_addfields.cat_feature_id WHERE sys_addfields.active IS TRUE AND param_name not IN 
(SELECT columnname FROM config_form_fields JOIN cat_feature ON cat_feature.child_layer=formname)', info_msg='All active features have child view defined in config_form_fields', function_name='[gw_fct_admin_check_data]' WHERE fid=316;
UPDATE sys_fprocess SET fprocess_name='Find ve_* views not defined in cat_feature', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check admin', addparam=NULL, except_level=2, except_msg='views defined in a DB but is not related to any feature in cat_feature.', except_msg_feature=NULL, query_text='select string_agg(child_layer,'','') FROM cat_feature where child_layer IS NOT NULL', info_msg='All views in DB are related to features in cat_feature', function_name='[gw_fct_admin_check_data]' WHERE fid=317;
UPDATE sys_fprocess SET fprocess_name='Check config_form_fields field datatype', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check admin', addparam=NULL, except_level=3, except_msg='features form fields in config_form_fields that don''''t have data type.', except_msg_feature=NULL, query_text='SELECT string_agg(concat(formname, '': '', columnname), ''; '') FROM config_form_fields WHERE datatype IS NULL AND formtype=''form_feature''', info_msg='All feature form fields have defined data type.', function_name='[gw_fct_admin_check_data]' WHERE fid=318;
UPDATE sys_fprocess SET fprocess_name='Check config_form_fields field widgettype', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check admin', addparam=NULL, except_level=3, except_msg='features form fields in config_form_fields that don''''t have widget type.', except_msg_feature=NULL, query_text='SELECT string_agg(concat(formname, '': '', columnname), ''; '') FROM config_form_fields WHERE widgettype IS NULL AND formtype=''form_feature''', info_msg='All feature form fields have defined widget type.', function_name='[gw_fct_admin_check_data]' WHERE fid=319;
UPDATE sys_fprocess SET fprocess_name='Check config_form_fields field dv_querytext', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check admin', addparam=NULL, except_level=3, except_msg='features form fields in config_form_fields that are combo or typeahead but don''''t have dv_querytext defined.', except_msg_feature=NULL, query_text='SELECT string_agg(concat(formname, '': '', columnname), ''; '') FROM config_form_fields WHERE (widgettype = ''combo'' or widgettype =''typeahead'') and dv_querytext is null and columnname !=''composer''
', info_msg='All feature form fields with widget type combo or typeahead have dv_querytext defined.', function_name='[gw_fct_admin_check_data]' WHERE fid=320;
UPDATE sys_fprocess SET fprocess_name='Check config_form_fields for addfields definition', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check admin', addparam=NULL, except_level=3, except_msg='addfields that are not defined in config_form_fields.', except_msg_feature=NULL, query_text='SELECT string_agg(param_name, ''; '') FROM sys_addfields 
JOIN cat_feature ON cat_feature.id=sys_addfields.cat_feature_id WHERE sys_addfields.active IS TRUE AND param_name not IN 
(SELECT columnname FROM config_form_fields JOIN cat_feature ON cat_feature.child_layer=formname)', info_msg='All addfields are defined in config_form_fields.', function_name='[gw_fct_admin_check_data]' WHERE fid=321;
UPDATE sys_fprocess SET fprocess_name='Check config_form_fields layoutorder duplicated', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check admin', addparam=NULL, except_level=3, except_msg='form names with duplicated layout order defined in config_form_fields: ''', except_msg_feature=NULL, query_text='SELECT array_agg(a.list::text) FROM (SELECT concat(''Formname: '',formname, '', layoutname: '',layoutname, '', layoutorder: '',layoutorder) as list FROM config_form_fields WHERE formtype = ''feature'' AND hidden is false 
group by layoutorder,formname,layoutname having count(*)>1)a', info_msg='All fields defined in config_form_fields have unduplicated order.', function_name='[gw_fct_admin_check_data]' WHERE fid=322;
UPDATE sys_fprocess SET fprocess_name='Check cat_arc field active', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-config', addparam=NULL, except_level=3, except_msg='rows without values on cat_arc.active column.', except_msg_feature=NULL, query_text='SELECT * FROM cat_arc WHERE active IS NULL', info_msg='There is/are no rows without values on cat_arc.active column.', function_name='[gw_fct_plan_check_data, gw_fct_admin_check_data]' WHERE fid=323;
UPDATE sys_fprocess SET fprocess_name='Check cat_arc field cost', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-config', addparam=NULL, except_level=2, except_msg='rows without values on cat_arc.cost column.', except_msg_feature=NULL, query_text='SELECT * FROM cat_arc WHERE cost IS NULL and active=TRUE', info_msg='There is/are no rows without values on cat_arc.cost column.', function_name='[gw_fct_plan_check_data, gw_fct_admin_check_data]' WHERE fid=324;
UPDATE sys_fprocess SET fprocess_name='Check cat_arc field m2bottom_cost', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-config', addparam=NULL, except_level=2, except_msg='rows without values on cat_arc.m2bottom_cost column.', except_msg_feature=NULL, query_text='SELECT * FROM cat_arc WHERE m2bottom_cost IS NULL and active=TRUE', info_msg='There is/are no rows without values on cat_arc.m2bottom_cost column.', function_name='[gw_fct_plan_check_data, gw_fct_admin_check_data]' WHERE fid=325;
UPDATE sys_fprocess SET fprocess_name='Check cat_arc field m3protec_cost', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-config', addparam=NULL, except_level=2, except_msg='rows without values on cat_arc.m3protec_cost column.', except_msg_feature=NULL, query_text='SELECT * FROM cat_arc WHERE m3protec_cost IS NULL and active=TRUE', info_msg='There is/are no rows without values on cat_arc.m3protec_cost column.', function_name='[gw_fct_plan_check_data, gw_fct_admin_check_data]' WHERE fid=326;
UPDATE sys_fprocess SET fprocess_name='Check cat_node field active', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-config', addparam=NULL, except_level=3, except_msg='rows without values on cat_node.active column.', except_msg_feature=NULL, query_text='SELECT * FROM cat_node WHERE active IS NULL', info_msg='There is/are no rows without values on cat_node.active column.', function_name='[gw_fct_plan_check_data, gw_fct_admin_check_data]' WHERE fid=327;
UPDATE sys_fprocess SET fprocess_name='Check cat_node field cost', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-config', addparam=NULL, except_level=2, except_msg='rows without values on cat_node.cost column.', except_msg_feature=NULL, query_text='SELECT * FROM cat_node WHERE cost IS NULL and active=TRUE', info_msg='There is/are no rows rows without values on cat_node.cost column.', function_name='[gw_fct_plan_check_data, gw_fct_admin_check_data]' WHERE fid=328;
UPDATE sys_fprocess SET fprocess_name='Check cat_node field cost_column', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-config', addparam=NULL, except_level=2, except_msg='rows without values on cat_node.cost_unit column.', except_msg_feature=NULL, query_text='SELECT * FROM cat_node WHERE cost_unit IS NULL and active=TRUE', info_msg='There is/are no rows without values on cat_node.cost_unit column.', function_name='[gw_fct_plan_check_data, gw_fct_admin_check_data]' WHERE fid=329;
UPDATE sys_fprocess SET fprocess_name='Check cat_connec field active', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-config', addparam=NULL, except_level=3, except_msg='rows without values on cat_connec.active column.', except_msg_feature=NULL, query_text='SELECT * FROM cat_connec WHERE active IS NULL', info_msg='There is/are no rows without values on cat_connec.active column column.', function_name='[gw_fct_plan_check_data, gw_fct_admin_check_data]' WHERE fid=332;
UPDATE sys_fprocess SET fprocess_name='Check cat_pavement field thickness', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-config', addparam=NULL, except_level=2, except_msg='rows without values on cat_pavement.thickness column.', except_msg_feature=NULL, query_text='SELECT * FROM cat_pavement WHERE thickness IS NULL', info_msg='There is/are no rows without values on cat_pavement.thickness column.', function_name='[gw_fct_plan_check_data, gw_fct_admin_check_data]' WHERE fid=336;
UPDATE sys_fprocess SET fprocess_name='Check cat_pavement field m2cost', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-config', addparam=NULL, except_level=2, except_msg='rows without values on cat_pavement.m2_cost column.', except_msg_feature=NULL, query_text='SELECT * FROM cat_pavement WHERE m2_cost IS NULL', info_msg='There is/are no rows without values on cat_pavement.m2_cost column.', function_name='[gw_fct_plan_check_data, gw_fct_admin_check_data]' WHERE fid=337;
UPDATE sys_fprocess SET fprocess_name='Check cat_soil field y_param', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-config', addparam=NULL, except_level=2, except_msg='rows without values on cat_soil.y_param column.', except_msg_feature=NULL, query_text='SELECT * FROM cat_soil WHERE y_param IS NULL', info_msg='There is/are no rows without values on cat_soil.y_param column.', function_name='[gw_fct_plan_check_data, gw_fct_admin_check_data]' WHERE fid=338;
UPDATE sys_fprocess SET fprocess_name='Check cat_soil field b', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-config', addparam=NULL, except_level=2, except_msg='rows without values on cat_soil.b column.', except_msg_feature=NULL, query_text='SELECT * FROM cat_soil WHERE b IS NULL', info_msg='There is/are no rows without values on cat_soil.b column.', function_name='[gw_fct_plan_check_data, gw_fct_admin_check_data]' WHERE fid=339;
UPDATE sys_fprocess SET fprocess_name='Check cat_soil field m3exc_cost', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-config', addparam=NULL, except_level=2, except_msg='rows without values on cat_soil.m3exc_cost column.', except_msg_feature=NULL, query_text='SELECT * FROM cat_soil WHERE m3exc_cost IS NULL', info_msg='There is/are no rows without values on cat_soil.m3exc_cost column.', function_name='[gw_fct_plan_check_data, gw_fct_admin_check_data]' WHERE fid=340;
UPDATE sys_fprocess SET fprocess_name='Check cat_soil field m3fill_cost', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-config', addparam=NULL, except_level=2, except_msg='rows without values on cat_soil.m3fill_cost column.', except_msg_feature=NULL, query_text='SELECT * FROM cat_soil WHERE m3fill_cost IS NULL', info_msg='There is/are no rows without values on cat_soil.m3fill_cost column.', function_name='[gw_fct_plan_check_data, gw_fct_admin_check_data]' WHERE fid=341;
UPDATE sys_fprocess SET fprocess_name='Check cat_soil field m3excess_cost', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-config', addparam=NULL, except_level=2, except_msg='rows without values on cat_soil.m3excess_cost column.', except_msg_feature=NULL, query_text='SELECT * FROM cat_soil WHERE m3excess_cost IS NULL', info_msg='There is/are no rows without values on cat_soil.m3excess_cost column.', function_name='[gw_fct_plan_check_data, gw_fct_admin_check_data]' WHERE fid=342;
UPDATE sys_fprocess SET fprocess_name='Check cat_soil field m2trenchl_cost', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-config', addparam=NULL, except_level=2, except_msg='rows without values on cat_soil.m2trenchl_cost column.', except_msg_feature=NULL, query_text='SELECT * FROM cat_soil WHERE m2trenchl_cost IS NULL', info_msg='There is/are no rows without values on cat_soil.m2trenchl_cost column.', function_name='[gw_fct_plan_check_data, gw_fct_admin_check_data]' WHERE fid=343;
UPDATE sys_fprocess SET fprocess_name='Check plan_arc_x_pavement rows number', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-config', addparam=NULL, except_level=1, except_msg='rows more in arc than in table plan_arc_x_pavement', except_msg_feature=NULL, query_text='with arcs as (SELECT count(*) as a FROM arc WHERE state>0),
pavs as (SELECT count(*) as b FROM plan_arc_x_pavement)
select case when b < a then a-b else 0 end from arcs, pavs', info_msg='The number of rows of the plan_arc_x_pavement table is same than the arc table.', function_name='[gw_fct_plan_check_data, gw_fct_admin_check_data]' WHERE fid=346;
UPDATE sys_fprocess SET fprocess_name='Check plan_arc_x_pavement field pavcat_id', project_type='utils', parameters=NULL, "source"='core', isaudit=false, fprocess_type='Check plan-config', addparam=NULL, except_level=2, except_msg='rows without values on plan_arc_x_pavement.pavcat_id column.', except_msg_feature=NULL, query_text='SELECT * FROM plan_arc_x_pavement WHERE pavcat_id IS NOT NULL', info_msg='There is/are no rows without values on rows without values on plan_arc_x_pavement.pavcat_id column.', function_name='[gw_fct_plan_check_data]' WHERE fid=347;
UPDATE sys_fprocess SET fprocess_name='Check final nodes of arc state=2 in psector', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-data', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=348;
UPDATE sys_fprocess SET fprocess_name='Check compatibility of DB and plugin version', project_type='utils', parameters=NULL, "source"='core', isaudit=false, fprocess_type='Check project', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=349;
UPDATE sys_fprocess SET fprocess_name='Check host of QGIS layers', project_type='utils', parameters=NULL, "source"='core', isaudit=false, fprocess_type='Check project', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=350;
UPDATE sys_fprocess SET fprocess_name='Check DB name of QGIS layers', project_type='utils', parameters=NULL, "source"='core', isaudit=false, fprocess_type='Check project', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=351;
UPDATE sys_fprocess SET fprocess_name='Check schema name of QGIS layers', project_type='utils', parameters=NULL, "source"='core', isaudit=false, fprocess_type='Check project', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=352;
UPDATE sys_fprocess SET fprocess_name='Check user name of QGIS layers', project_type='utils', parameters=NULL, "source"='core', isaudit=false, fprocess_type='Check project', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=353;
UPDATE sys_fprocess SET fprocess_name='Check arc state=2 with final nodes in psector', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-data', addparam=NULL, except_level=3, except_msg='operative arcs without final nodes in some psector.', except_msg_feature=NULL, query_text='SELECT DISTINCT ON (arc_id) * FROM (SELECT a.arc_id, a.arccat_id, pa.psector_id , node_1 as node, a.the_geom FROM v_edit_arc a  JOIN plan_psector_x_node pn1 ON pn1.node_id = a.node_1  left JOIN plan_psector_x_arc pa using (arc_id)  WHERE a.state = 1 AND pn1.state = 0 and pa.psector_id is null  UNION  SELECT a.arc_id, a.arccat_id, pa.psector_id, node_2, a.the_geom FROM v_edit_arc a  JOIN plan_psector_x_node pn2 ON pn2.node_id = a.node_2  left JOIN plan_psector_x_arc pa using (arc_id)  WHERE a.state = 1 AND pn2.state = 0 and pa.psector_id is null  ) b', info_msg='There are no arcs with state=1 with final nodes obsolete in psector.', function_name='[gw_fct_plan_check_data, gw_fct_admin_check_data]' WHERE fid=354;
UPDATE sys_fprocess SET fprocess_name='Check arc state=2 with operative nodes in psector', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-data', addparam=NULL, except_level=3, except_msg='planified arcs without final in some psector.', except_msg_feature=NULL, query_text='SELECT * FROM ( SELECT pa.arc_id, a.arccat_id, pa.psector_id , node_1 as node, a.the_geom FROM plan_psector_x_arc pa JOIN v_edit_arc a USING (arc_id) JOIN plan_psector_x_node pn1 ON pn1.node_id = a.node_1 WHERE pa.psector_id = pn1.psector_id AND pa.state = 1 AND pn1.state = 0 UNION SELECT pa.arc_id, a.arccat_id, pa.psector_id, node_2, a.the_geom FROM plan_psector_x_arc pa JOIN v_edit_arc a USING (arc_id) JOIN plan_psector_x_node pn2 ON pn2.node_id = a.node_2 WHERE pa.psector_id = pn2.psector_id AND pa.state = 1 AND pn2.state = 0) b', info_msg='There are no arcs with state=2 with final nodes obsolete in psector.', function_name='[gw_fct_plan_check_data, gw_fct_admin_check_data]' WHERE fid=355;
UPDATE sys_fprocess SET fprocess_name='Arc reverse', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=357;
UPDATE sys_fprocess SET fprocess_name='Reset user profile', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=358;
UPDATE sys_fprocess SET fprocess_name='Find features state=2 deleted with psector', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=360;
UPDATE sys_fprocess SET fprocess_name='Auxiliar cad polygons', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=361;
UPDATE sys_fprocess SET fprocess_name='Auxiliar cad lines', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=362;
UPDATE sys_fprocess SET fprocess_name='Check operative arcs with wrong topology', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-data', addparam=NULL, except_level=3, except_msg='operative arcs with wrong topology.', except_msg_feature=NULL, query_text='SELECT * FROM temp_t_arc WHERE state = 9', info_msg='All arcs has well-defined topology', function_name='[gw_fct_om_check_data, gw_fct_admin_check_data]' WHERE fid=372;
UPDATE sys_fprocess SET fprocess_name='Check features with sector_id = 0, not involved in the simulation', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-result', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=373;
UPDATE sys_fprocess SET fprocess_name='Check node2arc configuration', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-result', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=375;
UPDATE sys_fprocess SET fprocess_name='Graphanalytics LRS', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=376;
UPDATE sys_fprocess SET fprocess_name='Check undefined nodes as topological nodes', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-topology', addparam=NULL, except_level=2, except_msg='nodes with epa_type UNDEFINED acting as node_1 or node_2 of arcs. Please, check your data before continue.''', except_msg_feature=NULL, query_text='SELECT n.node_id, nodecat_id, the_geom, n.expl_id FROM 
(SELECT node_1 node_id, sector_id FROM v_edit_arc WHERE epa_type !=''UNDEFINED'' UNION 
SELECT node_2, sector_id FROM arc WHERE epa_type !=''UNDEFINED'' )a JOIN  
(SELECT node_id, nodecat_id, the_geom, expl_id FROM v_edit_node WHERE epa_type = ''UNDEFINED'') n USING (node_id) 
JOIN selector_sector USING (sector_id) WHERE n.node_id IS NOT NULL AND cur_user = current_user', info_msg='No nodes with epa_type UNDEFINED acting as node_1 or node_2 of arcs found.', function_name='[gw_fct_pg2epa_check_data, gw_fct_admin_check_data]' WHERE fid=379;
UPDATE sys_fprocess SET fprocess_name='Admin manage recreating views', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=380;
UPDATE sys_fprocess SET fprocess_name='Arc duplicated', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-data', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=381;
UPDATE sys_fprocess SET fprocess_name='Import inp curves', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=384;
UPDATE sys_fprocess SET fprocess_name='Import inp patterns', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=386;
UPDATE sys_fprocess SET fprocess_name='Find short arcs', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=387;
UPDATE sys_fprocess SET fprocess_name='Arcs shorter than value set as node proximity', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-topology', addparam=NULL, except_level=2, except_msg='arcs with length shorter than value set as node proximity. Please, check your data before continue', except_msg_feature=NULL, query_text='SELECT arc_id,arccat_id,st_length(the_geom), the_geom, expl_id, json_extract_path_text(value::json,''value'')::numeric as nprox 
FROM v_prefix_arc, config_param_system where parameter = ''edit_node_proximity'' 
and  st_length(the_geom) < json_extract_path_text(value::json,''value'')::numeric ', info_msg='No arcs shorter than value set as node proximity.', function_name='[gw_fct_om_check_data, gw_fct_admin_check_data]' WHERE fid=391;
UPDATE sys_fprocess SET fprocess_name='Check topocontrol for link', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=394;
UPDATE sys_fprocess SET fprocess_name='Check duplicity of features when more than one scenario is enabled', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-result', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=396;
UPDATE sys_fprocess SET fprocess_name='Parent psector forced when child psector is enabled', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=397;
UPDATE sys_fprocess SET fprocess_name='Check if node_id and arc_id defined on CONTROLS/RULES exists)', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-result', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=402;
UPDATE sys_fprocess SET fprocess_name='Copy dscenarios values', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=403;
UPDATE sys_fprocess SET fprocess_name='Check links connected on nodarcs', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-network', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=404;
UPDATE sys_fprocess SET fprocess_name='Repair nodes duplicated', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=405;
UPDATE sys_fprocess SET fprocess_name='EPA outlayer values', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-result', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=407;
UPDATE sys_fprocess SET fprocess_name='Connec without pjoint_id or pjoint_type', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-result', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=415;
UPDATE sys_fprocess SET fprocess_name='Links without connec on startpoint', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-topology', addparam=NULL, except_level=3, except_msg='links related to connecs with wrong topology, startpoint does not fit connec', except_msg_feature=NULL, query_text='SELECT * FROM temp_t_arc WHERE state = 1', info_msg='All connec links has connec on startpoint', function_name='[gw_fct_om_check_data, gw_fct_admin_check_data]' WHERE fid=417;
UPDATE sys_fprocess SET fprocess_name='Duplicated hydrometer related to more than one connec', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-data', addparam=NULL, except_level=2, except_msg='hydrometer related to more than one connec. HINT-419: Type ''''SELECT hydrometer_id, count(*) FROM v_rtc_hydrometer  group by hydrometer_id having count(*)> 1''''''', except_msg_feature=NULL, query_text='SELECT hydrometer_id, count(*) FROM v_rtc_hydrometer  group by hydrometer_id having count(*)> 1 ', info_msg='All hydrometeres are related to a unique connec', function_name='[gw_fct_om_check_data, gw_fct_admin_check_data]' WHERE fid=419;
UPDATE sys_fprocess SET fprocess_name='Check nodarcs', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-data', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=420;
UPDATE sys_fprocess SET fprocess_name='Check planned feature with state=0 on psector tables', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-data', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=426;
UPDATE sys_fprocess SET fprocess_name='Check expl.geom is not null when raster DEM is enabled', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-data', addparam=NULL, except_level=2, except_msg='exploitations without geometry. Capturing values from DEM is enabled, but it will fail on exploitation: '',string_agg(name,'', '')', except_msg_feature=NULL, query_text='SELECT * FROM exploitation WHERE the_geom IS NULL AND active IS TRUE and expl_id > 0 ', info_msg='Capturing values from DEM is enabled and will work correctly as all exploitations have geometry.', function_name='[gw_fct_om_check_data, gw_fct_admin_check_data]' WHERE fid=428;
UPDATE sys_fprocess SET fprocess_name='Check that EPA OBJECTS (curves) name do not contain spaces', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-config', addparam=NULL, except_level=3, except_msg='curves name with spaces. Please fix it!', except_msg_feature=NULL, query_text='SELECT * FROM inp_curve WHERE id like''% %''', info_msg='All curves checked have names without spaces.', function_name='[gw_fct_pg2epa_check_data, gw_fct_admin_check_data]' WHERE fid=429;
UPDATE sys_fprocess SET fprocess_name='Check matcat null for arcs', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-config', addparam=NULL, except_level=3, except_msg='arcs without matcat_id informed.''', except_msg_feature=NULL, query_text='SELECT * FROM selector_sector s, v_edit_arc a JOIN cat_arc c ON c.id = a.cat_matcat_id  
WHERE a.sector_id = s.sector_id and cur_user=current_user 
AND a.cat_matcat_id IS NULL AND sys_type !=''VARC''', info_msg='All arcs have matcat_id filled.', function_name='[gw_fct_pg2epa_check_data, gw_fct_admin_check_data]' WHERE fid=430;
UPDATE sys_fprocess SET fprocess_name='Check node ''T candidate'' with wrong topology', project_type='utils', parameters=NULL, "source"='core', isaudit=NULL, fprocess_type='Function process', addparam=NULL, except_level=3, except_msg='Nodes ''''T candidate'''' with wrong topology', except_msg_feature=NULL, query_text='with q_arc as (
select * from arc JOIN v_state_arc USING (arc_id))
SELECT b.* FROM (
	SELECT n1.node_id, n1.nodecat_id, n1.sector_id, n1.expl_id, n1.state, n1.the_geom  FROM q_arc, 
		(select * from node JOIN v_state_node USING (node_id)) n1 
	JOIN (SELECT node_1 node_id from q_arc UNION 
	select node_2 FROM q_arc) b USING (node_id) 
	WHERE st_dwithin(q_arc.the_geom, n1.the_geom,0.01) AND n1.node_id NOT IN 
	(node_1, node_2)
)b, selector_expl e 
where e.expl_id= b.expl_id AND cur_user=current_user', info_msg='All Nodes T has right topology.', function_name='[gw_fct_om_check_data, gw_fct_pg2epa_check_data, gw_fct_admin_check_data]' WHERE fid=432;
UPDATE sys_fprocess SET fprocess_name='Backup and restore tables', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=434;
UPDATE sys_fprocess SET fprocess_name='Store hydrometer user selector values', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=435;
UPDATE sys_fprocess SET fprocess_name='Change node type', project_type='utils', parameters=NULL, "source"='core', isaudit=NULL, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=436;
UPDATE sys_fprocess SET fprocess_name='Check estimated depth', project_type='utils', parameters=NULL, "source"='core', isaudit=false, fprocess_type='Function process', addparam=NULL, except_level=2, except_msg='rows without values on cat_arc.estimated_depth column.', except_msg_feature=NULL, query_text='SELECT * FROM cat_arc WHERE estimated_depth IS NOT NULL and active=TRUE', info_msg='There is/are no rows without values on cat_arc.estimated_depth column.', function_name='[gw_fct_plan_check_data]' WHERE fid=437;
UPDATE sys_fprocess SET fprocess_name='Create dscenario with empty values', project_type='utils', parameters=NULL, "source"='core', isaudit=NULL, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=438;
UPDATE sys_fprocess SET fprocess_name='Set integer id on import inp', project_type='utils', parameters=NULL, "source"='core', isaudit=false, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=439;
UPDATE sys_fprocess SET fprocess_name='Import cat_feature_arc table', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=444;
UPDATE sys_fprocess SET fprocess_name='Import cat_feature_node table', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=445;
UPDATE sys_fprocess SET fprocess_name='Import cat_feature_connec table', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=446;
UPDATE sys_fprocess SET fprocess_name='Import cat_node table', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=448;
UPDATE sys_fprocess SET fprocess_name='Import cat_connec table', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=449;
UPDATE sys_fprocess SET fprocess_name='Import cat_arc table', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=450;
UPDATE sys_fprocess SET fprocess_name='Planified arc without start-end nodes', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-data', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=452;
UPDATE sys_fprocess SET fprocess_name='Node planified duplicated', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-data', addparam=NULL, except_level=3, except_msg='nodes duplicated with state 2.', except_msg_feature=NULL, query_text='SELECT * FROM (SELECT DISTINCT t1.node_id AS node_1, t1.nodecat_id AS nodecat_1, t1.state as state1, t2.node_id AS node_2, t2.nodecat_id AS nodecat_2, t2.state as state2, t1.expl_id, 453, t1.the_geom FROM v_prefix_node AS t1 JOIN v_prefix_node AS t2 ON ST_Dwithin(t1.the_geom, t2.the_geom, 0.01) WHERE t1.node_id != t2.node_id ORDER BY t1.node_id ) a where a.state1 = 2 AND a.state2 = 2', info_msg='There are no nodes duplicated with state 2', function_name='[gw_fct_plan_check_data, gw_fct_om_check_data, gw_fct_admin_check_data]' WHERE fid=453;
UPDATE sys_fprocess SET fprocess_name='Check node_1 and node_2 on temp_table', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=454;
UPDATE sys_fprocess SET fprocess_name='Duplicate dscenario', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=459;
UPDATE sys_fprocess SET fprocess_name='Check number of rows in a plan_price table', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check plan-config', addparam=NULL, except_level=2, except_msg='rows on plan_price table. Revise the data and remove unnecessary rows.', except_msg_feature=NULL, query_text='with c as (SELECT row_number() over() as rowid, * FROM plan_price) select*from c where rowid > 300', info_msg='The number of rows on plan price is acceptable.', function_name='[gw_fct_plan_check_data, gw_fct_admin_check_data]' WHERE fid=465;
UPDATE sys_fprocess SET fprocess_name='Import scada values', project_type='utils', parameters=NULL, "source"='core', isaudit=false, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=469;
UPDATE sys_fprocess SET fprocess_name='Import hydro_x_data values', project_type='utils', parameters=NULL, "source"='core', isaudit=false, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=470;
UPDATE sys_fprocess SET fprocess_name='Import crm period values', project_type='utils', parameters=NULL, "source"='core', isaudit=false, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=471;
UPDATE sys_fprocess SET fprocess_name='Check consistency between cat_manager and config_user_x_expl', project_type='utils', parameters=NULL, "source"='core', isaudit=false, fprocess_type='Function process', addparam=NULL, except_level=3, except_msg='inconsistent configurations on cat_manager and config_user_x_expl for user: '''',string_agg(DISTINCT usern,'''', '''')),''||v_count||'' FROM ''||v_querytext||'';''"', except_msg_feature=NULL, query_text='WITH exploit AS (
SELECT COALESCE(m.rolname, s.rolname) AS usern, id FROM (
SELECT id, unnest(rolename) AS role FROM cat_manager WHERE expl_id IS NOT NULL) q 
LEFT JOIN pg_roles r ON q.role = r.rolname LEFT JOIN pg_auth_members am ON r.oid = am.roleid 
LEFT JOIN pg_roles m ON am.member = m.oid AND m.rolcanlogin = TRUE  LEFT JOIN pg_roles s ON q.role = s.rolname AND s.rolcanlogin = TRUE 
WHERE (m.rolcanlogin IS TRUE OR s.rolcanlogin IS TRUE)
) 
SELECT *, CONCAT(explots, ''-'', usern, ''-'', id) FROM (SELECT id, unnest(expl_id) explots, usern FROM cat_manager   JOIN exploit using(id)) a 
WHERE CONCAT(explots, ''-'', usern, ''-'', id) NOT IN (SELECT CONCAT(expl_id, ''-'', username, ''-'', manager_id) FROM config_user_x_expl cuxe) AND explots != 0', info_msg='Configuration of cat_manager and config_user_x_expl is consistent.', function_name='[gw_fct_admin_check_data]' WHERE fid=472;
UPDATE sys_fprocess SET fprocess_name='Check consistency between cat_manager and config_user_x_sector', project_type='utils', parameters=NULL, "source"='core', isaudit=false, fprocess_type='Function process', addparam=NULL, except_level=3, except_msg='inconsistent configurations on cat_manager and config_user_x_sector for user: '''',string_agg(DISTINCT usern,'''', '''')), ''||v_count||'' FROM ''||v_querytext||'';''"', except_msg_feature=NULL, query_text='WITH sectores AS (SELECT COALESCE(m.rolname, s.rolname) AS usern,  id  FROM (SELECT id, unnest(rolename) AS role FROM cat_manager WHERE sector_id IS NOT NULL) q 
LEFT JOIN pg_roles r ON q.role = r.rolname
LEFT JOIN pg_auth_members am ON r.oid = am.roleid
LEFT JOIN pg_roles m ON am.member = m.oid AND m.rolcanlogin = TRUE
LEFT JOIN pg_roles s ON q.role = s.rolname AND s.rolcanlogin = TRUE
WHERE (m.rolcanlogin IS TRUE OR s.rolcanlogin IS TRUE))
SELECT *, CONCAT(sectors, ''-'', usern, ''-'', id) FROM (SELECT id, unnest(sector_id) sectors, usern FROM cat_manager JOIN sectores using(id)) a 
WHERE CONCAT(sectors, ''-'', usern, ''-'', id) NOT IN (SELECT CONCAT(sector_id, ''-'', username, ''-'', manager_id) FROM config_user_x_sector cuxe) AND sectors NOT IN (0, -1)', info_msg='Configuration of cat_manager and config_user_x_sector is consistent.', function_name='[gw_fct_admin_check_data]' WHERE fid=473;
UPDATE sys_fprocess SET fprocess_name='Check duplicated arcs', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-data', addparam=NULL, except_level=3, except_msg='arcs with duplicated geometry.', except_msg_feature=NULL, query_text='SELECT arc_id, arccat_id, state1, arc_id_aux, node_1, node_2, expl_id, the_geom FROM        
 (WITH q_arc AS (SELECT * FROM arc JOIN v_state_arc using (arc_id)) 
 SELECT DISTINCT t1.arc_id, t1.arccat_id, t1.state as state1, t2.arc_id as arc_id_aux,
 t2.state as state2, t1.node_1, t1.node_2, t1.expl_id, t1.the_geom 
 FROM q_arc AS t1 JOIN q_arc AS t2 USING(the_geom) JOIN arc v ON t1.arc_id = v.arc_id
 WHERE t1.arc_id != t2.arc_id ORDER BY t1.arc_id )a
 where a.state1 > 0 AND a.state2 > 0', info_msg='No arcs with duplicated geometry.', function_name='[gw_fct_om_check_data, gw_fct_admin_check_data]' WHERE fid=479;
UPDATE sys_fprocess SET fprocess_name='Check arcs with value of custom length', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check epa-data', addparam=NULL, except_level=2, except_msg='percent of arcs have value on custom_length.', except_msg_feature=NULL, query_text='WITH cust_len AS (SELECT count(*) FROM v_edit_arc WHERE custom_length IS NOT NULL), 
		arcs AS (SELECT count(*) FROM v_edit_arc),
		thres as (SELECT json_extract_path_text(value::json,''customLength'',''maxPercent'')::NUMERIC as t FROM config_param_system WHERE parameter = ''epa_outlayer_values'')
		SELECT round(cust_len.count::numeric / arcs.count::numeric *100, 2) FROM arcs, cust_len, thres
		where round(cust_len.count::numeric / arcs.count::numeric *100, 2) > t', info_msg='No arcs have value on custom_length.', function_name='[gw_fct_pg2epa_check_data, gw_fct_admin_check_data]' WHERE fid=482;
UPDATE sys_fprocess SET fprocess_name='Connect link to arc id with specific coordinates', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type=NULL, addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=485;
UPDATE sys_fprocess SET fprocess_name='Get address values from closest street number', project_type='utils', parameters=NULL, "source"='core', isaudit=false, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=486;
UPDATE sys_fprocess SET fprocess_name='Configuration of border nodes', project_type='utils', parameters=NULL, "source"='core', isaudit=false, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=487;
UPDATE sys_fprocess SET fprocess_name='Massive node interpolation', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=496;
UPDATE sys_fprocess SET fprocess_name='Modify mapzone configuration', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=512;
UPDATE sys_fprocess SET fprocess_name='Node rotation update', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=516;
UPDATE sys_fprocess SET fprocess_name='Set end feature', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=518;
UPDATE sys_fprocess SET fprocess_name='Psector merge', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=520;
UPDATE sys_fprocess SET fprocess_name='Set repair psector', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Function process', addparam=NULL, except_level=NULL, except_msg=NULL, except_msg_feature=NULL, query_text=NULL, info_msg=NULL, function_name=NULL WHERE fid=521;

UPDATE sys_fprocess SET fprocess_name='Connec without link', project_type='utils', parameters=NULL, "source"='core', isaudit=true, fprocess_type='Check om-topology', addparam=NULL, except_level=2, except_msg='connecs without links or connecs over arc without arc_id.', except_msg_feature=NULL, query_text='SELECT connec_id, connecat_id, c.the_geom, c.expl_id from v_prefix_connec c WHERE c.state= 1 
AND connec_id NOT IN (SELECT feature_id FROM link) EXCEPT  
SELECT connec_id, connecat_id, c.the_geom, c.expl_id FROM v_prefix_connec c 
LEFT JOIN arc a USING (arc_id) WHERE c.state= 1 
AND arc_id IS NOT NULL AND st_dwithin(c.the_geom, a.the_geom, 0.1)', info_msg='All connecs have links or are over arc with arc_id.', function_name='[gw_fct_om_check_data, gw_fct_admin_check_data]' WHERE fid=204;