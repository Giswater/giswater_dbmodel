/*
This file is part of Giswater 3
The program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
This version of Giswater is provided by Giswater Association
*/
BEGIN;

-- Suppress NOTICE messages
SET client_min_messages TO WARNING;

SET search_path = "SCHEMA_NAME", public, pg_catalog;

SELECT plan(6);

INSERT INTO v_edit_sector (sector_id, "name", sector_type, macrosector_id, descript, undelete, graphconfig, stylesheet, parent_id, pattern_id, tstamp, insert_user, lastupdate, lastupdate_user, avg_press, link, the_geom, muni_id, expl_id, idval)
VALUES(-901, 'sector2-1d', 'DISTRIBUTION', 2, NULL, NULL, '{"use":[{"nodeParent":"113952", "toArc":[114146]}], "ignore":[], "forceClosed":[]}'::json, '{"color":[255,255,204], "featureColor":"255,255,204"}'::json, NULL, 'PTN-SECT-05-DEF', '2024-02-21 12:08:16.880', 'postgres', NULL, NULL, NULL, NULL, 'SRID=25831;MULTIPOLYGON (((418408.77290029166 4577679.471398888, 418406.95992662845 4577680.35577703, 418406.6432100942 4577680.534818714, 418406.27541217156 4577680.773268913, 418405.98269770853 4577680.989332622, 418305.21990028984 4577765.2664396465, 418304.9891756808 4577765.4809832815, 418292.9813855306 4577777.884523421, 418292.62273189717 4577778.334293052, 418292.35651966854 4577778.844250108, 418292.19253732474 4577779.395643744, 418292.13681440835 4577779.968199511, 418292.19139982073 4577780.540864843, 418320.0899992315 4577924.783422026, 418320.2082600872 4577925.217335073, 418320.3900584135 4577925.628693228, 418323.75245777366 4577931.914918118, 418324.0743163974 4577932.397688845, 418324.4830893769 4577932.809471797, 418341.58746873087 4577946.990025621, 418341.82186615013 4577947.16577337, 418364.97690827097 4577962.821287245, 418365.1414209857 4577962.924911722, 418378.0948905177 4577970.509275174, 418394.7757881472 4577982.964835297, 418394.89037626743 4577983.046286655, 418426.905189091 4578004.6920406865, 418426.95736783685 4578004.726532512, 418445.96223378583 4578017.006599741, 418445.98007212294 4578017.018036951, 418483.5512301911 4578040.920310662, 418484.020635741 4578041.163712067, 418521.8841763625 4578056.733083018, 418521.94485182076 4578056.757263776, 418535.1314531879 4578061.846829378, 418538.6106574883 4578063.18968, 418538.8631950208 4578063.274472719, 418594.1234975491 4578079.136226221, 418594.6805244217 4578079.240429443, 418595.24720904266 4578079.238023471, 418595.8033310186 4578079.129094153, 418596.3290468516 4578078.917528298, 418596.8055979931 4578078.610874979, 418612.8866384116 4578065.96532956, 418612.9861630217 4578065.883548844, 418621.7576396133 4578058.3546981, 418622.2796254795 4578057.772319653, 418629.88157185906 4578046.661782637, 418630.1783115691 4578046.113308579, 418630.3552481966 4578045.515335605, 418633.5714562804 4578028.191669337, 418633.5786370869 4578028.151468183, 418641.72910997295 4577980.656439819, 418641.77231976425 4577980.157263409, 418641.7318484788 4577979.657857513, 418639.9557420818 4577968.95621806, 418640.2486000963 4577968.887434306, 418640.7954489417 4577968.701905776, 418641.29662074876 4577968.415041149, 418641.7335462951 4577968.037469219, 418642.09003678535 4577967.583179636, 418642.8237408156 4577966.435878587, 418643.0865877033 4577965.921703511, 418643.24605208763 4577965.366693957, 418649.10657084925 4577933.768949303, 418654.94437933277 4577902.293650049, 418655.7403932463 4577898.971181805, 418655.77973581315 4577898.779611059, 418665.7407179237 4577840.73425167, 418665.74512192234 4577840.707884154, 418682.4867017507 4577737.64932781, 418682.5223891717 4577737.031294973, 418681.45367856364 4577713.652739344, 418687.02543948236 4577707.049152667, 418687.3346541137 4577706.6075663185, 418687.55984657037 4577706.117769882, 418687.693745333 4577705.595579005, 418688.258578508 4577702.118554005, 418688.26325209363 4577702.088843952, 418702.5899971936 4577607.941661866, 418702.62145626394 4577607.36345286, 418702.54124357225 4577606.789971166, 418702.35234762344 4577606.242583143, 418702.0618061627 4577605.741682964, 418701.6804439685 4577605.3059328, 418701.22246955073 4577604.951567507, 418700.70494578074 4577604.691789764, 418700.14715417556 4577604.536278177, 418698.38154180767 4577604.223677955, 418697.7830784726 4577604.178684583, 418697.18763466325 4577604.253714156, 418696.6190402241 4577604.44576397, 418696.1000504794 4577604.74714813, 418695.6514355583 4577605.14580515, 418695.2911491678 4577605.625780653, 418695.2668363935 4577605.666000962, 418695.01339646237 4577606.196692169, 418694.8683590274 4577606.766629971, 418687.9107889502 4577652.487804764, 418617.9364306897 4577704.7830121, 418599.26739103434 4577701.795937204, 418599.2605306667 4577701.794847679, 418599.2522485211 4577701.793542184, 418599.2453856023 4577701.792468539, 418596.0134625402 4577701.290694564, 418654.65708064684 4577601.226472236, 418654.944068509 4577600.565721938, 418655.06526542985 4577599.855606247, 418655.0961307187 4577599.222179264, 418655.0624909183 4577598.605227823, 418654.9031752789 4577598.0082527455, 418654.6249416285 4577597.456576435, 418654.23959204246 4577596.973599818, 418653.76347222447 4577596.579809728, 418653.2167781571 4577596.291909897, 418652.6226994313 4577596.1221124185, 418633.26464516297 4577592.694784777, 418633.1919177105 4577592.682827896, 418500.30404734437 4577572.508431735, 418499.6113136968 4577572.48425917, 418494.2022364652 4577572.922832998, 418493.5821628086 4577573.039684612, 418493.0002457164 4577573.283648006, 418492.48222827225 4577573.643930626, 418481.664073809 4577583.0001723245, 418481.47110221 4577583.182605969, 418456.2075763108 4577609.27876135, 418455.9533352182 4577609.578381195, 418444.97427346226 4577624.3827269105, 418440.4371478237 4577630.5006610295, 418440.3917132395 4577630.563612114, 418440.3378650087 4577630.640292185, 418440.2940745621 4577630.704397861, 418429.5030238262 4577646.948990366, 418426.69828584476 4577651.171176575, 418426.6803662995 4577651.198473391, 418426.6589169718 4577651.231537964, 418426.6412955736 4577651.259028234, 418408.77290029166 4577679.471398888)))'::public.geometry, NULL, NULL, 'DISTRIBUTION');

SELECT is((SELECT count(*)::integer FROM v_edit_sector WHERE sector_id = -901), 1, 'INSERT: v_edit_sector -901 was inserted');
SELECT is((SELECT count(*)::integer FROM sector WHERE sector_id = -901), 1, 'INSERT: sector -901 was inserted');

UPDATE v_edit_sector SET descript = 'updated descript' WHERE sector_id = -901;
SELECT is((SELECT descript FROM v_edit_sector WHERE sector_id = -901), 'updated descript', 'UPDATE: v_edit_sector -901 was updated');
SELECT is((SELECT descript FROM sector WHERE sector_id = -901), 'updated descript', 'UPDATE: sector -901 was updated');

DELETE FROM v_edit_sector WHERE sector_id = -901;
SELECT is((SELECT count(*)::integer FROM v_edit_sector WHERE sector_id = -901), 0, 'DELETE: v_edit_sector -901 was deleted');
SELECT is((SELECT count(*)::integer FROM sector WHERE sector_id = -901), 0, 'DELETE: sector -901 was deleted');


SELECT * FROM finish();


ROLLBACK;